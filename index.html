<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firefox 最新版本直接下载地址 - 官方安装包免费下载</title>
    <meta name="description" content="提供 Firefox 最新版本直接下载地址，无需跳转页面即可下载官方安装包。支持 Windows、macOS、Linux 全平台，快速获取 Mozilla Firefox 浏览器最新版本。">
    <meta name="keywords" content="Firefox下载,Firefox最新版本,Firefox直接下载,火狐浏览器下载,Mozilla Firefox,官方下载">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            background: #1c1c1e;
            min-height: 100vh;
            color: #f2f2f7;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 60px;
        }
        
        .hero-image {
            width: 100%;
            max-width: 500px;
            height: auto;
            margin: 0;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.4);
        }
        
        .firefox-logo {
            width: 200px;
            height: auto;
            margin: 0 auto 30px;
            display: block;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: start;
            margin-bottom: 60px;
        }
        
        .left-column {
            display: flex;
            flex-direction: column;
        }
        
        .right-column {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        h1 {
            color: #f2f2f7;
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #98989d;
            font-size: 1.2rem;
            font-weight: 300;
        }
        
        .main-card {
            background: #2c2c2e;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            overflow: hidden;
            margin-bottom: 30px;
        }
        
        .version-info {
            padding: 40px;
            text-align: center;
            background: linear-gradient(135deg, #0060df, #0a84ff);
            color: white;
            border-radius: 16px;
        }
        
        .version-info .status-text {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        
        .version-info h3 {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 10px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .version-number {
            font-size: 3rem;
            font-weight: 700;
            margin: 10px 0;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .download-section {
            padding: 40px;
            background: #2c2c2e;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .download-section h3 {
            font-size: 1.8rem;
            margin-bottom: 30px;
            color: #f2f2f7;
            text-align: center;
            font-weight: 600;
        }
        
        .download-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .download-item {
            background: #1c1c1e;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #3a3a3c;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .download-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            border-color: #0060df;
        }
        
        .download-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0060df, #0a84ff);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .download-item:hover::before {
            transform: scaleX(1);
        }
        
        .platform-info {
            margin-bottom: 0;
        }
        
        .platform-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #f2f2f7;
            margin-bottom: 5px;
        }
        
        .platform-details {
            color: #98989d;
            font-size: 0.9rem;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #0060df, #0a84ff);
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
            font-size: 1rem;
        }
        
        .download-btn:hover {
            background: linear-gradient(135deg, #0040b8, #0060df);
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(0,96,223,0.3);
        }
        
        .download-btn::after {
            content: '↓';
            font-size: 1.2rem;
        }
        
        .official-link {
            background: linear-gradient(135deg, #6b46c1, #8b5cf6);
            grid-column: 1 / -1;
            margin-top: 20px;
        }
        
        .official-link:hover {
            background: linear-gradient(135deg, #553c9a, #6b46c1);
        }
        
        .official-link .download-btn::after {
            content: '→';
        }
        
        .loading {
            color: #98989d;
            font-size: 1.1rem;
        }
        
        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #3a3a3c;
            border-radius: 50%;
            border-top-color: #0060df;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error {
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
        }
        
        .footer {
            text-align: center;
            color: #98989d;
            margin-top: 40px;
        }
        
        .footer a {
            color: #0a84ff;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .disclaimer {
            background: #2c2c2e;
            border-radius: 12px;
            padding: 30px;
            margin-top: 40px;
            text-align: center;
            border: 1px solid #3a3a3c;
        }
        
        .disclaimer h4 {
            color: #f2f2f7;
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .disclaimer p {
            color: #98989d;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .disclaimer a {
            color: #0a84ff;
            text-decoration: none;
        }
        
        .disclaimer a:hover {
            text-decoration: underline;
        }
        
        .disclaimer .note {
            font-size: 0.9rem;
            color: #8e8e93;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #3a3a3c;
        }
        
        .cache-info {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 15px;
            text-align: center;
        }
        
        @media (max-width: 968px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 40px;
            }
            
            .right-column {
                order: -1;
            }
            
            .download-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .version-number {
                font-size: 2.2rem;
            }
            
            .download-grid {
                gap: 15px;
                grid-template-columns: 1fr;
            }
            
            .download-item {
                text-align: center;
            }
            
            .firefox-logo {
                width: 150px;
                margin-bottom: 20px;
            }
            
            .hero-image {
                max-width: 100%;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="assets/logo-word-hor.svg" alt="Firefox Logo" class="firefox-logo">
            <h1>Firefox 最新版本直接下载地址</h1>
            <p class="subtitle">无需跳转，快速获取官方安装包 • 支持全平台直接下载</p>
        </div>
        
        <div class="main-content">
            <div class="left-column">
                <div id="version-info" class="version-info">
                    <div id="status-text" class="status-text">正在获取最新版本信息...</div>
                    <h3>当前最新版本</h3>
                    <div id="version-text" class="version-number" style="display: none;"></div>
                    <div id="cache-info" class="cache-info" style="display: none;"></div>
                </div>
            </div>
            
            <div class="right-column">
                <img src="assets/hero-high-res.png" alt="Firefox Browser" class="hero-image">
            </div>
        </div>
        
        <div id="download-links" class="download-section" style="display: none;">
            <h3>选择平台立即下载</h3>
            <div id="downloads-container" class="download-grid"></div>
        </div>
        
        <div class="disclaimer">
            <h4>直接下载说明</h4>
            <p>本页面提供 Firefox 最新版本的直接下载地址，点击即可开始下载官方安装包：</p>
            <p><a href="https://ftp.mozilla.org/pub/firefox/" target="_blank" rel="noopener">https://ftp.mozilla.org/pub/firefox/</a></p>
            <p>无需跳转其他页面，直接获取 Mozilla 官方原版安装文件，支持 Windows、macOS、Linux 全平台。</p>
            <div class="note">
                本站与 Mozilla 无任何关系 • <a href="https://github.com/scavin/Firefox-latest-releases" target="_blank">本页面源代码托管在 GitHub</a>
            </div>
        </div>
        
        <div class="footer">
            <p>Firefox 浏览器由 <a href="https://www.mozilla.org/" target="_blank">Mozilla</a> 开发 • 保护您的隐私权</p>
        </div>
    </div>

    <script>
        class FirefoxReleaseChecker {
            constructor() {
                this.statusTextEl = document.getElementById('status-text');
                this.versionInfoEl = document.getElementById('version-info');
                this.versionTextEl = document.getElementById('version-text');
                this.downloadLinksEl = document.getElementById('download-links');
                this.downloadsContainerEl = document.getElementById('downloads-container');
                this.cacheInfoEl = document.getElementById('cache-info');
                
                // 缓存配置
                this.cacheKey = 'firefox_version_cache';
                this.cacheExpiration = 24 * 60 * 60 * 1000; // 24小时（毫秒）
                
                this.init();
            }
            
            async init() {
                try {
                    // 检查缓存
                    const cachedData = this.getCachedVersion();
                    if (cachedData) {
                        this.displayVersionInfo(cachedData.version);
                        await this.getDownloadLinks(cachedData.version);
                        this.showCacheInfo(cachedData.timestamp);
                        this.hideStatusAfterDelay();
                    } else {
                        await this.getLatestVersion();
                    }
                } catch (error) {
                    this.showError('获取版本信息失败: ' + error.message);
                }
            }
            
            getCachedVersion() {
                try {
                    const cached = localStorage.getItem(this.cacheKey);
                    if (!cached) return null;
                    
                    const data = JSON.parse(cached);
                    const now = Date.now();
                    
                    // 检查是否过期
                    if (now - data.timestamp > this.cacheExpiration) {
                        localStorage.removeItem(this.cacheKey);
                        return null;
                    }
                    
                    return data;
                } catch (error) {
                    localStorage.removeItem(this.cacheKey);
                    return null;
                }
            }
            
            setCachedVersion(version) {
                try {
                    const data = {
                        version: version,
                        timestamp: Date.now()
                    };
                    localStorage.setItem(this.cacheKey, JSON.stringify(data));
                } catch (error) {
                    console.warn('无法保存缓存:', error);
                }
            }
            
            showCacheInfo(timestamp) {
                const cacheTime = new Date(timestamp);
                const now = new Date();
                const diffHours = Math.floor((now - cacheTime) / (1000 * 60 * 60));
                const diffMinutes = Math.floor((now - cacheTime) / (1000 * 60));
                
                let timeText;
                if (diffMinutes < 60) {
                    if (diffMinutes < 1) {
                        timeText = '刚刚';
                    } else {
                        timeText = `${diffMinutes}分钟前`;
                    }
                } else if (diffHours < 24) {
                    timeText = `${diffHours}小时前`;
                } else {
                    const diffDays = Math.floor(diffHours / 24);
                    timeText = `${diffDays}天前`;
                }
                
                this.cacheInfoEl.textContent = `版本信息缓存于${timeText}`;
                this.cacheInfoEl.style.display = 'block';
            }
            
            hideStatusAfterDelay() {
                setTimeout(() => {
                    this.statusTextEl.style.display = 'none';
                }, 3000); // 3秒后隐藏加载状态
            }
            
            async getLatestVersion() {
                this.updateStatus('正在获取最新版本信息...');
                
                try {
                    // 尝试多个API源获取最新版本
                    const version = await this.tryMultipleSources();
                    if (version) {
                        this.displayVersionInfo(version);
                        await this.getDownloadLinks(version);
                        // 保存到缓存
                        this.setCachedVersion(version);
                    } else {
                        throw new Error('无法获取版本信息');
                    }
                } catch (error) {
                    await this.getVersionFromMozilla();
                }
            }
            
            async tryMultipleSources() {
                const sources = [
                    () => this.getVersionFromMozillaProduct(),
                    () => this.getVersionFromFTPDirectory(),
                    () => this.getVersionFromGitHub()
                ];
                
                for (const source of sources) {
                    try {
                        const version = await source();
                        if (version) return version;
                    } catch (error) {
                        console.log('Source failed:', error.message);
                    }
                }
                return null;
            }
            
            async getVersionFromMozillaProduct() {
                // 使用Mozilla的产品详情API
                const response = await fetch('https://product-details.mozilla.org/1.0/firefox_versions.json');
                if (!response.ok) throw new Error('Mozilla API failed');
                
                const data = await response.json();
                return data.LATEST_FIREFOX_VERSION || data.FIREFOX_NIGHTLY;
            }
            
            async getVersionFromFTPDirectory() {
                // 由于CORS限制，这个方法可能无法工作，但保留作为备选
                try {
                    const response = await fetch('https://ftp.mozilla.org/pub/firefox/releases/', {mode: 'no-cors'});
                    // 由于no-cors模式无法读取响应，这里只是尝试连接
                    throw new Error('CORS restriction');
                } catch (error) {
                    throw new Error('FTP access failed');
                }
            }
            
            async getVersionFromGitHub() {
                const response = await fetch('https://api.github.com/repos/mozilla/gecko-dev/releases/latest');
                if (!response.ok) throw new Error('GitHub API failed');
                
                const data = await response.json();
                // GitHub的标签格式通常是 FIREFOX_XXX_X_X_RELEASE
                const tag = data.tag_name;
                if (tag && tag.includes('FIREFOX_')) {
                    // 提取版本号，例如从 FIREFOX_141_0_RELEASE 提取 141.0
                    const versionMatch = tag.match(/FIREFOX_(\d+)_(\d+)(?:_(\d+))?/);
                    if (versionMatch) {
                        const major = versionMatch[1];
                        const minor = versionMatch[2] || '0';
                        const patch = versionMatch[3] || '';
                        return patch ? `${major}.${minor}.${patch}` : `${major}.${minor}`;
                    }
                }
                return null;
            }
            
            async getVersionFromMozilla() {
                try {
                    // 如果所有API都失败，使用手动维护的版本号（需要定期更新）
                    const commonVersion = "141.0"; // 根据你提到的最新版本更新
                    this.displayVersionInfo(commonVersion + " (预设版本，建议访问官网确认)");
                    this.generateDownloadLinks(commonVersion);
                } catch (error) {
                    this.showError('无法获取版本信息，请手动访问 Mozilla 官网下载');
                }
            }
            
            displayVersionInfo(version) {
                this.versionTextEl.textContent = version.replace(/[()]/g, '');
                // 如果版本号包含括号内容，显示在副标题中
                if (version.includes('(')) {
                    const versionParts = version.split('(');
                    this.versionTextEl.textContent = versionParts[0].trim();
                    const subtitle = document.createElement('div');
                    subtitle.style.fontSize = '1rem';
                    subtitle.style.opacity = '0.8';
                    subtitle.style.marginTop = '10px';
                    subtitle.textContent = '(' + versionParts[1];
                    this.versionTextEl.appendChild(subtitle);
                }
                this.versionTextEl.style.display = 'block';
                this.updateStatusWithTime('版本信息获取成功');
            }
            
            generateDownloadLinks(version) {
                const baseUrl = 'https://ftp.mozilla.org/pub/firefox/releases';
                const downloads = [
                    {
                        name: 'Windows 64位',
                        url: `${baseUrl}/${version}/win64/zh-CN/Firefox%20Setup%20${version}.exe`,
                        platform: 'Windows x64'
                    },
                    {
                        name: 'Windows 32位',
                        url: `${baseUrl}/${version}/win32/zh-CN/Firefox%20Setup%20${version}.exe`,
                        platform: 'Windows x86'
                    },
                    {
                        name: 'macOS',
                        url: `${baseUrl}/${version}/mac/zh-CN/Firefox%20${version}.dmg`,
                        platform: 'macOS'
                    },
                    {
                        name: 'Linux 64位',
                        url: `${baseUrl}/${version}/linux-x86_64/zh-CN/firefox-${version}.tar.bz2`,
                        platform: 'Linux x64'
                    }
                ];
                
                this.displayDownloadLinks(downloads);
            }
            
            async getDownloadLinks(version) {
                this.updateStatus('正在生成下载链接...');
                
                try {
                    // 由于直接访问FTP会有CORS问题，我们生成标准的下载链接
                    this.generateDownloadLinks(version.replace('FIREFOX_', '').replace(/_/g, '.'));
                } catch (error) {
                    this.showError('生成下载链接失败: ' + error.message);
                }
            }
            
            displayDownloadLinks(downloads) {
                this.downloadsContainerEl.innerHTML = '';
                
                downloads.forEach(download => {
                    const downloadItem = document.createElement('div');
                    downloadItem.className = 'download-item';
                    
                    downloadItem.innerHTML = `
                        <div class="platform-info">
                            <div class="platform-name">${download.name}</div>
                            <div class="platform-details">${download.platform}</div>
                        </div>
                        <a href="${download.url}" class="download-btn" target="_blank" rel="noopener">下载</a>
                    `;
                    
                    this.downloadsContainerEl.appendChild(downloadItem);
                });
                
                this.downloadLinksEl.style.display = 'block';
                this.updateStatusWithTime('下载链接生成完成');
                
                // 添加官方下载页面链接
                const officialLinkItem = document.createElement('div');
                officialLinkItem.className = 'download-item official-link';
                officialLinkItem.innerHTML = `
                    <div class="platform-info">
                        <div class="platform-name">官方下载页面</div>
                        <div class="platform-details">访问 Mozilla 官方网站获取最新版本</div>
                    </div>
                    <a href="https://www.mozilla.org/zh-CN/firefox/new/" class="download-btn" target="_blank" rel="noopener">访问官网</a>
                `;
                this.downloadsContainerEl.appendChild(officialLinkItem);
            }
            
            updateStatus(message) {
                this.statusTextEl.innerHTML = `<div class="loading">${message}</div>`;
            }
            
            updateStatusWithTime(message) {
                const now = new Date();
                const timeString = now.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                // 先显示加载状态
                this.statusTextEl.innerHTML = `<div class="loading">${message}</div>`;
                
                // 2秒后显示时间，再过1秒隐藏
                setTimeout(() => {
                    this.statusTextEl.innerHTML = `<div class="update-time">最近更新：${timeString}</div>`;
                    
                    setTimeout(() => {
                        this.statusTextEl.style.display = 'none';
                    }, 1000);
                }, 2000);
            }
            
            showError(message) {
                this.statusTextEl.innerHTML = `<div style="color: #ff6b6b;">${message}</div>`;
            }
        }
        
        // 页面加载完成后启动
        document.addEventListener('DOMContentLoaded', () => {
            new FirefoxReleaseChecker();
        });
    </script>
</body>
</html>